<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />



    <meta name="generator" content="Wowchemy 5.6.0 for Hugo" />






































  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />







      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">














  <meta name="author" content="Michaël Karpe" />






  <meta name="description" content="Automatic and optimal course allocation with wishlists from students" />


  <link rel="alternate" hreflang="en-us" href="https://michaelkarpe.github.io/optimization-projects/allocation/" />




    <meta name="theme-color" content="#3f51b5" />





    <script src="/js/mathjax-config.js"></script>




  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">






      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">











































































































        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>


























  <link rel="stylesheet" href="/css/wowchemy.9c4c13a48bae91f201c0af6081455e43.css" />










    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>








<script async src="https://www.googletagmanager.com/gtag/js?id=G-695H905YSX"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));
  }

  gtag('js', new Date());
  gtag('config', 'G-695H905YSX', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});


  document.addEventListener('click', onClickCallback, false);
</script>






















    <link rel="manifest" href="/manifest.webmanifest" />



  <link rel="icon" type="image/png" href="/media/icon_hu942ec82bbfdd4b8fc9bf90d8cd76fd06_20106_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu942ec82bbfdd4b8fc9bf90d8cd76fd06_20106_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://michaelkarpe.github.io/optimization-projects/allocation/" />


















  <meta property="twitter:card" content="summary_large_image" />

    <meta property="twitter:site" content="@wowchemy" />
    <meta property="twitter:creator" content="@wowchemy" />

  <meta property="og:site_name" content="Michaël Karpe" />
  <meta property="og:url" content="https://michaelkarpe.github.io/optimization-projects/allocation/" />
  <meta property="og:title" content="Optimal Course Allocation | Michaël Karpe" />
  <meta property="og:description" content="Automatic and optimal course allocation with wishlists from students" /><meta property="og:image" content="https://michaelkarpe.github.io/optimization-projects/allocation/featured.jpg" />
    <meta property="twitter:image" content="https://michaelkarpe.github.io/optimization-projects/allocation/featured.jpg" /><meta property="og:locale" content="en-us" />


      <meta
        property="article:published_time"
        content="2017-03-20T00:00:00&#43;00:00"
      />

    <meta property="article:modified_time" content="2017-03-20T00:00:00&#43;00:00">











  <title>Optimal Course Allocation | Michaël Karpe</title>
















</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="f08fd276e2959e581d3e4deaec32e1d0" >










  <script src="/js/wowchemy-init.min.1ee5462d74c6c0de1f8881b384ecc58d.js"></script>




<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">

        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">

      </div>






    </section>
    <section class="section-search-results">

      <div id="search-hits">

      </div>

    </section>
  </div>
</aside>



  <div class="page-header">













<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">


      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Michaël Karpe</a>
      </div>



      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>



      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Michaël Karpe</a>
      </div>




      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">


        <ul class="navbar-nav d-md-inline-flex">
































          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>


































          <li class="nav-item">
            <a class="nav-link " href="/#kaggle-competitions"><span>Kaggle Competitions</span></a>
          </li>


































          <li class="nav-item">
            <a class="nav-link " href="/#computer-vision-projects"><span>Computer Vision</span></a>
          </li>


































          <li class="nav-item">
            <a class="nav-link " href="/#machine-learning-projects"><span>Machine Learning</span></a>
          </li>


































          <li class="nav-item">
            <a class="nav-link " href="/#optimization-projects"><span>Optimization</span></a>
          </li>


































          <li class="nav-item">
            <a class="nav-link " href="/#programming-projects"><span>Programming</span></a>
          </li>


































          <li class="nav-item">
            <a class="nav-link " href="/#quantitative-finance-projects"><span>Quantitative Finance</span></a>
          </li>


































          <li class="nav-item">
            <a class="nav-link " href="/#publications"><span>Publications</span></a>
          </li>







        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
















      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">




    <article class="article">



























<div class="article-container pt-3">
  <h1>Optimal Course Allocation</h1>


  <p class="page-subtitle">Automatic and optimal course allocation with wishlists from students</p>





<div class="article-metadata">





  <div>


  <span >
      Michaël Karpe</span>, <span >
      Hervé Andres</span>, <span >
      Marc-Antoine Augé</span>, <span >
      Reda Bahi Slaoui</span>, <span >
      Imad Lakim</span>
  </div>




  <span class="article-date">




    Mar 20, 2017
  </span>














</div>






<div class="btn-links mb-3">
















<a class="btn btn-outline-primary btn-page-header" href="/optimization-projects/allocation/Report_Course_Allocation.pdf" target="_blank" rel="noopener">
  PDF
</a>








<a class="btn btn-outline-primary btn-page-header" href="https://github.com/MichaelKarpe/ponts-paristech-projects/tree/master/optimization/course-allocation" target="_blank" rel="noopener">
  Code
</a>














</div>


</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 243px;">
  <div style="position: relative">
    <img src="/optimization-projects/allocation/featured_hu9c9a0dca73ca988beeb3e1eee0e30aaa_223198_720x2500_fit_q75_h2_lanczos.webp" width="720" height="243" alt="" class="featured-image">

  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <p> </p>
<h1 id="presentation-of-the-project">Presentation of the project</h1>
<p>As part of the management of the assignment of first year students to second semester courses and projects at Ecole des Ponts, we were asked to design a computer program that manages the assignment of students to courses. In order to meet the requirements of the first year department, this program must comply with a number of constraints.</p>
<p>Our objective is to optimize the process of assigning students to courses and projects, by proposing a distribution of students that respects as much as possible the ranking of their wishes. Indeed, we have three main sets of courses and projects:</p>
<ul>
<li>the department projects: there are $20$ projects in $2017$ and they take place on Monday afternoons.</li>
<li>the opening courses: they are spread over $4$ days, each day having a well-specified set of courses that the students have to classify.</li>
<li>introductory research projects: these are associated with the opening classes. Each opening course has a project on the same theme. As a result, every student must necessarily be assigned to a project that is associated with one of the courses he or she is taking.</li>
</ul>
<p>In addition, each course and each project has a maximum number of students and a minimum number of students required to open the course. These numbers may vary from one course to another. Finally, some courses or projects may be discontinued if demand is not high enough.</p>
<p> </p>
<h1 id="mathematical-modelling">Mathematical modelling</h1>
<h2 id="optimization-program-for-a-single-project--course-choice">Optimization program for a single project / course choice</h2>
<p>In order to account for the fact that a student has or has not received his first wish, we have introduced a regret function, the value of which is all the higher as the first wishes are not fulfilled. Our modeling aims at minimizing the total regret function. For a given project, the regret function of a student corresponds to the weight function evaluated at the wish number of the project. The weight function is a function that associates a number to a wish number that is higher the higher the wish number is, and is worth $0$ if it is the student&rsquo;s $1$ wish. An example of a quadratic weight function ($f(x) = (x - 1)^2$) is given below :</p>
<table>
<thead>
<tr>
<th>Rank</th>
<th>Weight</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>4</td>
<td>9</td>
</tr>
<tr>
<td>5</td>
<td>16</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
</tbody>
</table>
<p>In order to know to which project a student is assigned, we use a matrix $A = (a_{e,p})<em>{e,p}$ whose coefficient $a</em>{e,p}$ is $1$ if student $e$ is assigned to project $p$ and $0$ otherwise. Given this, the regret function of a student for a given project is $\sum_{p\in P} a_{e,p} w(c_{e,p})$. This minimization problem comes with several constraints:</p>
<ul>
<li>The enrolment of the project numbered $p$, noted $n_{p}$ and defined as the sum over the students of the assignments $a_{e,p}$, must be between the minimum $m_{p}$ and the maximum $M_{p}$ enrolment associated with this project. These bounds are multiplied by a binary variable $\delta_{p}$ which equals $0$ if the project is closed and $1$ if it is open. Thus, if there are not enough students who have applied for a given project, that is, if it is not in the first wishes of a sufficient number of students, then the project in question will have a zero enrolment.</li>
<li>Each student must be assigned to one project only. For this purpose, the sum of the student&rsquo;s $a_{e,p}$ assignments on projects is equal to $1$.</li>
</ul>
<p>Mathematically, the problem thus modeled is written as follows:</p>
<p>$$\text{min} \sum_{e \in E} \sum_{p \in P} a_{e, p}.w(c_{e, p}) + Kr_{max}$$
$$\text{s.t.} \ \forall p \in P, \ n_p = \sum_{e\in E} a_{e, p}$$
$$\forall p \in P, \ \delta_p.m_p \leq n_p$$
$$\forall p \in P, \ n_p \leq \delta_p.M_p$$
$$\forall e \in E, \ \sum_{p \in P} a_{e, p} = 1$$
$$\forall p \in P, \ \delta_p \in {0, 1}$$
$$\forall p \in P, \ \forall e \in E, \ a_{e, p} \in {0, 1}$$</p>
<p> </p>
<h3 id="settings">Settings</h3>
<ul>
<li>$J$: All days, two courses or projects on the same day cannot be cumulated.</li>
<li>$E$: All students.</li>
<li>$P$: Set of all projects / courses to be chosen partitioned according to days $P = \bigcup_{j \in J} P_j$.</li>
<li>$C$: Matrix of students&rsquo; choices tq. $c_{e, p}$ is the rank of the project $p$ for the student $e$.</li>
<li>$m_p$ and $M_p$: Minimum and maximum numbers for the $p$ project.</li>
<li>$w$: Weight function.</li>
<li>$pr$: Function that, with an opening course, associates a project of initiation to the search.</li>
<li>$K$: Constant increasing total regret.</li>
</ul>
<p> </p>
<h3 id="variables">Variables</h3>
<ul>
<li>$\delta_p = 1$ if project $p$ is open, $0$ otherwise.</li>
<li>$A$ : Student assignment matrix tq $a_{e, p} = $1 if student $e$ is assigned to project $p$, $0$ otherwise.</li>
<li>$n_p$ : Enrollment in project $p$.</li>
<li>$r_{max}$ : Maximum pupil regret. May be a parameter.</li>
</ul>
<p> </p>
<h2 id="optimization-program-for-multiple-project-or-course-choices">Optimization program for multiple project or course choices</h2>
<p>When there are several projects or courses to choose from, the allocation results must take into account each other. For example, if a student is assigned to a Wish $3$, their other assignments should correspond, as much as possible, to Wish $1$ courses. This is accomplished by adding a variable $r_{max}$ which corresponds to the maximum regret per student. Each student&rsquo;s regret ($\sum_{p \in P} a_{e, p}w(c_{e, p})$) is therefore increased by $r_{max}$.</p>
<p>In order to minimize this maximum regret, this variable is added to the total regret in the function to be minimized with a multiplicative coefficient $K$. This coefficient is a major of the total regret, therefore a very large number, so that the maximum regret per student only increases if there is no other possibility.</p>
<p>Finally, it must be ensured that if a student is assigned to a research project, then he or she is necessarily assigned to the associated opening course. Consequently, the assignment variable $a_{e,p}$ to a given opening course $p$ increases the assignment variable $a_{e, pr(p)}$ of the associated research project. Hence the reformulation of the previous problem as :</p>
<p>$$\text{min} \sum_{e \in E} \sum_{p \in P} a_{e, p}w(c_{e, p}) + Kr_{max}$$
$$\textrm{s.c.} \ \forall p \in P, \ n_p = \sum_{e_\in E} a_{e, p}$$
$$\forall p \in P, \ \delta_p.m_p \leq n_p$$
$$\forall p \in P, \ n_p \leq \delta_p.M_p$$
$$\forall e \in E, \ \sum_{p \in P} a_{e, p}.w(c_{e, p}) \leq r_{max}$$
$$\forall j \in J, \ \sum_{p \in P_j} a_{e, p} = 1$$
$$\forall e \in E, \ \forall p \in P_{\text{c.o.}}, \ a_{e, pr(p)} \leq a_{e, p}$$
$$\forall p \in P, \ \delta_p \in {0, 1}$$
$$\forall p \in P, \ \forall e \in E, \ a_{e, p} \in {0, 1}$$</p>
<p> </p>
<h1 id="results">Results</h1>
<h2 id="year-2017">Year 2017</h2>
<p>We compared our program to the $2017$ allocation results. We could see in the modeling that the fundamental parameter of the optimization is the $w$ weight function. By playing with the weights, we can change the result of the optimization entirely. In the case of our problem, we want to give massively first or second choices, while exceptionally allowing third choices. To do this, we worked with the weight function below, as well as with another weight function where the weight of the $3$ rank goes from $15$ to $50$.</p>
<table>
<thead>
<tr>
<th>Rank</th>
<th>Weight</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>5</td>
</tr>
<tr>
<td>3</td>
<td>15</td>
</tr>
<tr>
<td>4</td>
<td>1000</td>
</tr>
<tr>
<td>5</td>
<td>10000</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
</tbody>
</table>
<p>Let&rsquo;s compare the results obtained for these two weight functions with the results of the current optimization. The results are summarized in the table below, since with our optimization program we obtain the same results as those obtained manually by the administration: they were already at an optimum.</p>
<table>
<thead>
<tr>
<th>Choice</th>
<th>Monday</th>
<th>Tuesday</th>
<th>Wednesday</th>
<th>Thursday</th>
<th>Research</th>
<th>Department</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>137</td>
<td>126</td>
<td>114</td>
<td>111</td>
<td>92</td>
<td>107</td>
</tr>
<tr>
<td>2</td>
<td>5</td>
<td>16</td>
<td>28</td>
<td>31</td>
<td>45</td>
<td>35</td>
</tr>
<tr>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>5</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Above all, our software saves time since it runs in about $30$ seconds. The method previously used required to manually take over the results of the algorithm and lasted about $15$ hours. The time saved is therefore considerable.</p>
<p> </p>
<h2 id="year-2018">Year 2018</h2>
<p>Due to the very good results of our software in $2017$, it has been used every year since then by the first year department. Here are the results obtained for the year $2018$, where $152$ students had to grant wishes, compared to $142$ the year before:</p>
<table>
<thead>
<tr>
<th>Choice</th>
<th>Monday</th>
<th>Tuesday</th>
<th>Wednesday</th>
<th>Thursday</th>
<th>Research</th>
<th>Department</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>121</td>
<td>143</td>
<td>120</td>
<td>110</td>
<td>102</td>
<td>NC</td>
</tr>
<tr>
<td>2</td>
<td>30</td>
<td>7</td>
<td>31</td>
<td>40</td>
<td>43</td>
<td>NC</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>7</td>
<td>NC</td>
</tr>
</tbody>
</table>
<p>The results are very satisfying, although there is an increase in the number of wishes $3$. This is mainly due to the fact that despite the increase in the number of students, the number of students in the proposed courses has not been revised upwards.</p>
<p> </p>
<!---

&nbsp;

# Présentation du projet

Dans le cadre de la gestion de l'affectation des élèves de première année aux cours et projets du second semestre à l'Ecole des Ponts, il nous a été demandé de concevoir un programme informatique qui gère l'affectation des élèves aux cours. Pour qu'il réponde aux exigences du département de première année, ce programme doit respecter un certain nombre de contraintes.

Notre objectif est d'optimiser le processus d'affectation des élèves aux cours et aux projets, en proposant une répartition des élèves qui respecte au maximum le classement de leurs voeux. En effet, nous disposons de trois grands ensembles de cours et de projets :
- les projets de département : ils sont au nombre de $20$ en $2017$ et se déroulent le lundi après-midi.

- les cours d'ouverture : ils se répartissent sur $4$ jours, chaque jour disposant d'un ensemble bien spécifié de cours que les élèves doivent classer.
- les projets d'initiation à la recherche : ils sont associés aux cours d'ouverture. Chaque cours d'ouverture dispose d'un projet qui porte sur le même thème. De ce fait, tout élève doit nécessairement être affecté à un projet qui est associé à l'un des cours qu'il suit.

D'autre part, chaque cours et chaque projet possède un effectif maximal d'élèves et un effectif minimal nécessaire à l'ouverture du cours. Ces effectifs peuvent varier d'un cours à un autre. Enfin, certains cours ou projets peuvent être supprimés si la demande n'est pas assez forte.

&nbsp;

# Modélisation mathématique

## Programme d'optimisation pour un seul choix de projet/cours

Afin de rendre compte du fait qu'un élève a ou n'a pas reçu son premier voeu, nous avons introduit une fonction de regret dont la valeur est d'autant plus élevée que les premiers voeux ne sont pas remplis. Notre modélisation vise à minimiser la fonction de regret total. Pour un projet donné, la fonction de regret d'un élève correspond à la fonction de poids évaluée au numéro de voeu du projet. La fonction de poids est une fonction qui, à un numéro de voeu, associe un nombre d'autant plus élevé que le numéro du voeu est élevé, et qui vaut $0$ s'il s'agit du voeu $1$ de l'élève. Un exemple de fonction de poids quadratique ($f(x) = (x - 1)^2$) est donné ci-dessous :

| Rang     | Poids    |
|----------|----------|
| 1        | 0        |
| 2        | 1        |
| 3        | 4        |
| 4        | 9        |
| 5        | 16       |
| ...      | ...      |

Afin de savoir à quel projet un élève est affecté, on utilise une matrice $A = (a_{e,p})_{e,p}$ dont le coefficient $a_{e,p}$ vaut $1$ si l'élève e est affecté au projet p et $0$ sinon. Compte tenu de cela, la fonction de regret d'un élève pour un projet donné est $\sum_{p\in P} a_{e,p} w(c_{e,p})$. Ce problème de minimisation s'accompagne de plusieurs contraintes:

- L'effectif du projet numéroté $p$, noté $n_{p}$ et défini comme la somme sur les élèves des affectations $a_{e,p}$, doit être compris entre l'effectif minimum $m_{p}$ et l'effectif maximum $M_{p}$ associés à ce projet. Ces bornes sont multipliées par une variable binaire $\delta_{p}$ qui est égale à $0$ si le projet est fermé et $1$ s'il est ouvert. Ainsi, s'il n'y a pas assez d'élèves qui ont demandé un projet donné, c'est-à-dire qu'il ne figure pas dans les premiers voeux d'un nombre suffisant d'élèves, alors le projet en question aura un effectif nul.
- Chaque élève doit être affecté à un seul et unique projet. À cet effet, la somme sur les projets des affectations $a_{e,p}$ de l'élève est égale à $1$.

Mathématiquement, le problème ainsi modélisé s'écrit :

$$\text{min} \sum_{e \in E} \sum_{p \in P} a_{e, p}.w(c_{e, p}) + Kr_{max}$$
$$\text{s.c.} \ \forall p \in P, \ n_p = \sum_{e\in E} a_{e, p}$$
$$\forall p \in P, \ \delta_p.m_p \leq n_p$$
$$\forall p \in P, \ n_p \leq \delta_p.M_p$$
$$\forall e \in E, \ \sum_{p \in P} a_{e, p} = 1$$
$$\forall p \in P, \ \delta_p \in \{0, 1\}$$
$$\forall p \in P, \ \forall e \in E, \ a_{e, p} \in \{0, 1\}$$

&nbsp;

### Paramètres

- $J$ : Ensemble des jours, deux cours ou projets le même jour ne peuvent pas être cumulés.
- $E$ : Ensemble des élèves.
- $P$ : Ensemble de tous les projets / cours à choisir partitionnés selon les jours $P = \bigcup_{j \in J} P_j$.
- $C$ : Matrice des choix des élèves tq. $c_{e, p}$ est le rang du projet $p$ pour l'élève $e$.
- $m_p$ et $M_p$ : Effectifs minimal et maximal pour le projet $p$.
- $w$ : Fonction de poids.
- $pr$ : Fonction qui, à un cours d'ouverture, associe un projet d'initiation à la recherche.
- $K$ : Constante majorant le regret total.

&nbsp;

### Variables

- $\delta_p = 1$ si le projet p est ouvert, $0$ sinon.
- $A$ : Matrice d'affectation des élèves tq $a_{e, p} = 1$ si l'élève $e$ est affecté au projet $p$, $0$ sinon.
- $n_p$ : Effectif dans le projet $p$.
- $r_{max}$ : Regret par élève maximal. Éventuellement un paramètre.

&nbsp;

## Programme d'optimisation pour plusieurs choix de projets ou cours

Lorsqu'il y a plusieurs projets ou cours à choisir, il faut que les résultats d'affectation tiennent compte les uns des autres. Ainsi, si par exemple un étudiant est affecté à un projet placé en voeu $3$, ses autres affectations doivent correspondre, dans la mesure du possible, à des cours placés en voeu 1. Pour cela, on ajoute une variable $r_{max}$ qui correspond au regret maximal par élève. Le regret de chaque élève ($\sum_{p \in P} a_{e, p}w(c_{e, p})$) est donc majoré par $r_{max}$.

De façon à minimiser ce regret maximum, on ajoute cette variable au regret total dans la fonction à minimiser avec un coefficient multiplicatif $K$. Ce coefficient est un majorant du regret total, donc un nombre très grand, de façon à ce que le regret maximal par élève n'augmente que s'il n'y a pas d'autre possibilité.

Enfin, il faut faire en sorte que si un élève est attribué à un projet de recherche, alors il est nécessairement attribué au cours d'ouverture associé. En conséquence, la variable d'affectation $a_{e,p}$ à un cours d'ouverture donné $p$ majore la variable d'affectation $a_{e, pr(p)}$ du projet de recherche associé. D'où la reformulation du problème précédent sous la forme :

$$\text{min} \sum_{e \in E} \sum_{p \in P} a_{e, p}w(c_{e, p}) + Kr_{max}$$
$$\textrm{s.c.} \ \forall p \in P, \ n_p = \sum_{e_\in E} a_{e, p}$$
$$\forall p \in P, \ \delta_p.m_p \leq n_p$$
$$\forall p \in P, \ n_p \leq \delta_p.M_p$$
$$\forall e \in E, \ \sum_{p \in P} a_{e, p}.w(c_{e, p}) \leq r_{max}$$
$$\forall j \in J, \ \sum_{p \in P_j} a_{e, p} = 1$$
$$\forall e \in E, \ \forall p \in P_{\text{c.o.}}, \ a_{e, pr(p)} \leq a_{e, p}$$
$$\forall p \in P, \ \delta_p \in \{0, 1\}$$
$$\forall p \in P, \ \forall e \in E, \ a_{e, p} \in \{0, 1\}$$

&nbsp;

# Résultats

## Année 2017

Nous avons comparé notre programme aux résultats d'affectation obtenus en $2017$. Nous avons pu voir dans la modélisation que le paramètre fondamental de l'optimisation est la fonction de poids $w$. En jouant sur les poids, on peut changer entièrement le résultat de l'optimisation. Dans le cas de notre problème, on souhaite donner massivement des premiers ou des deuxièmes choix, tout en autorisant exceptionnellement les troisièmes choix. Pour cela, nous avons travaillé avec la fonction de poids ci-dessous, ainsi qu'avec une autre fonction de poids où le poids du rang $3$ passe de $15$ à $50$.

| Rang     | Poids    |
|----------|----------|
| 1        | 0        |
| 2        | 5        |
| 3        | 15       |
| 4        | 1000     |
| 5        | 10000    |
| ...      | ...      |

Comparons les résultats obtenus pour ces deux fonctions de poids avec les résultats de l'optimisation actuelle. Les résultats sont synthétisés dans le tableau ci-dessous, puisque nous obtenons avec notre programme d'optimisation les mêmes résultats que ceux obtenus manuellement par l'administration : ils correspondaient donc déjà à un optimum.

| Choix | Lundi | Mardi | Mercredi | Jeudi | Recherche | Département |
|-------|-------|-------|----------|-------|-----------|-------------|
| 1     | 137   | 126   | 114      | 111   | 92        | 107         |
| 2     | 5     | 16    | 28       | 31    | 45        | 35          |
| 3     | 0     | 0     | 0        | 0     | 5         | 0           |

Notre logiciel offre surtout un gain de temps puisqu'il tourne en une trentaine de secondes. La méthode précédemment employée obligeait à reprendre manuellement les résultats de l'algorithme et durait environ $15$ heures. Le gain de temps est donc considérable.

&nbsp;

## Année 2018

En raison des très bons résultats de notre logiciel en $2017$, celui-ci est depuis utilisé tous les ans par le département de première année. Voici les résultats obtenus pour l'année $2018$, où $152$ élèves ont eu à réaliser des voeux, contre $142$ l'année précédente :

| Choix | Lundi | Mardi | Mercredi | Jeudi | Recherche | Département |
|-------|-------|-------|----------|-------|-----------|-------------|
| 1     | 121   | 143   | 120      | 110   | 102       | NC          |
| 2     | 30    | 7     | 31       | 40    | 43        | NC          |
| 3     | 1     | 2     | 1        | 2     | 7         | NC          |

Les résultats sont très satisfaisants, bien que l'on constate une augmentation du nombre de voeux $3$. Cela est notamment dû au fait que malgré l'augmentation du nombre d'élèves, les effectifs des cours proposés n'ont pas été revus à la hausse.

&nbsp;

--->

    </div>









<div class="share-box">
  <ul class="share">

  </ul>
</div>
























  <div class="media author-card content-widget-hr">


      <a href="https://michaelkarpe.github.io/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu66194438bc6e14d260870deead871271_609448_270x270_fill_q75_lanczos_center.jpg" alt="Michaël Karpe"></a>


    <div class="media-body">
      <h5 class="card-title"><a href="https://michaelkarpe.github.io/">Michaël Karpe</a></h5>
      <h6 class="card-subtitle">Quantitative Developer</h6>
      <p class="card-text">Quantitative Developer at Next Gate Tech. MEng in Industrial Engineering &amp; Operations Research, FinTech Concentration at University of California, Berkeley. Diplôme d&rsquo;Ingénieur (MSc) in Applied Mathematics &amp; Computer Science, Machine Learning &amp; Computer Vision Concentration at Ecole des Ponts ParisTech, France.</p>
      <ul class="network-icon" aria-hidden="true">












    <li>
      <a href="https://www.linkedin.com/in/michaelkarpe/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>












    <li>
      <a href="https://github.com/MichaelKarpe" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>










    <li>
      <a href="https://scholar.google.com/citations?user=2yQ3TvgAAAAJ" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>












    <li>
      <a href="https://www.kaggle.com/mika30" target="_blank" rel="noopener">
        <i class="fab fa-kaggle"></i>
      </a>
    </li>

</ul>

    </div>
  </div>











































  </div>
</article>
  </div>

  <div class="page-footer">


    <div class="container">
      <footer class="site-footer">





























  <p class="powered-by copyright-license-text">
    © Michaël Karpe 2022. All rights reserved.
  </p>





  <p class="powered-by">










  </p>
</footer>

    </div>

  </div>




<script src="/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js"></script>
























  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>

    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>



























<script id="page-data" type="application/json">{"use_headroom":true}</script>



  <script src="/js/wowchemy-headroom.c251366b4128fd5e6b046d4c97a62a51.js" type="module"></script>












<script src="/en/js/wowchemy.min.54dd6e4d8f2e4b1d098381b57f18dd83.js"></script>








<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">

        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>
















</body>
</html>
